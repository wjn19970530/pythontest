config:
    name: testcase description
    variables:
        phoneNum: ${ENV(phoneNum)}
        verifyCode: ${ENV(verifyCode)}
    base_url: ${ENV(base_url)}
    export:
        -  access_token
        -  refresh_token

teststeps:
-   name: 获取验证码 /uaaaccount/api/account/verify-code
    request:
        headers:
            end-point: pc-web
        method: GET
        params:
            phoneNum: ${phoneNum}
        url: /uaaaccount/api/account/verify-code
    validate:
    -   eq: ["status_code", 200]

-   name: 登录 /auth/login
    request:
        headers:
            Content-Type: application/json;charset=UTF-8
        json:
            endpoint: pc-web
            grantType: verify_code
            phoneNum: ${phoneNum}
            productCode: image-char-captcha
            transactionNo: 91f0cb46ce9d428fa11ce8cc7f25eea5
            verifyCode: ${verifyCode}
        method: POST
        url: /auth/login
    extract:
        access_token: content.access_token
        refresh_token: content.refresh_token
    validate:
    -   eq: ["status_code", 200]

-   name: 获取账户信息 /uaaaccount/api/account
    request:
        headers:
            Authorization: Bearer ${access_token}
            Refresh: ${refresh_token}
        method: GET
        url: /uaaaccount/api/account
    validate:
    -   eq: [status_code, 200]
    -   eq: [content.userId, '3479189832092106759']
    -   eq: [content.login, $phoneNum]
    -   eq: [content.phoneNum, $phoneNum]
    -   eq: [content.tenantCode, '1001']

