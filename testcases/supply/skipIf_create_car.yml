config:
    name: 创建车辆  testcases/supply/skipIf_create_car.yml
    variables:
      phoneNum: ${ENV(phoneNum)}
      verifyCode: ${ENV(verifyCode)}
      access_token: ${get_token(access_token)}
      refresh_token: ${get_token(refresh_token)}
      engineNumber: ${generate_number()}
    base_url: ${ENV(base_url)}
    teardown_hooks:
      - ${sleep(5)}

teststeps:
-   name: 获取brandId api/mall/back-end/GET_CarBrands.yml
    api: api/mall/back-end/GET_CarBrands.yml
    validate:
      - eq: ["status_code", 200]

-   name: 获取产权归属  api/supplychain/cars/POST_PropertyList.yml
    api: api/supplychain/cars/POST_PropertyList.yml
    validate:
      - eq: [status_code,200]
    extract:
      - propertyId: content.0.signPartId

-   name: 获取车辆详细信息  api/mall/back-end/GET_CarTypesParams.yml
    api: api/mall/back-end/GET_CarTypesParams.yml
    variables:
        carFullName: ${get_config(carFullName)}
    validate:
      - eq: [status_code,200]
    teardown_hooks:
      - ${save_car_details_info($response,$carFullName)}

-   name: 获取待售车辆数量  api/supplychain/GET_UnlockedCars.yml
    api: api/supplychain/GET_UnlockedCars.yml
    variables:
      carTypeName: ${get_config(carFullName)}
      carStstus: 4
    validate:
      - eq: [status_code,200]
    teardown_hooks:
      - ${save_skip_create_car($response)}

-   name: 保存新的车辆基本信息  api/supplychain/POST_Cars.yml
    api: api/supplychain/POST_Cars.yml
    skipIf: ${get_value_from_tmp(skip)}
    variables:
      engineNumber: $engineNumber
      brandId: ${tmp_file_get_brand_id()}
      seriesId: ${get_value_from_tmp(seriesId)}
      typeId: ${get_value_from_tmp(typeId)}
      propertyId: ${propertyId}
    extract:
      carId: content.carId
      vin: content.vin
    validate:
      - eq: ["status_code", 201]